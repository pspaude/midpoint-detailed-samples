<?xml version="1.0"?>
<resource xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
          xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
          xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3"
          xmlns:org="http://midpoint.evolveum.com/xml/ns/public/common/org-3"
          xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
          xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instance-3"
          xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          oid="31cef34a-8142-4c5a-bdc7-c769c7cfbba9"
          version="1">
    <name>Outbound Role Requests to Grouper</name>
    <description>Sends Requests from midPoint to Grouper for entry into various groups. [MP_GR_GROUP_REQUESTS table]</description>
    <connectorRef relation="org:default" type="c:ConnectorType">
        <description>
            Use Scripted SQL Connector
        </description>
        <filter>
            <q:equal>
                <q:path>connectorType</q:path>
                <q:value>com.evolveum.polygon.connector.scripted.sql.ScriptedSQLConnector</q:value>
            </q:equal>
        </filter>
    </connectorRef>
    <connectorConfiguration xmlns:icfc="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/connector-schema-3">
        <icfc:configurationProperties xmlns:icscscriptedsql="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/bundle/com.evolveum.polygon.connector-scripted-sql/com.evolveum.polygon.connector.scripted.sql.ScriptedSQLConnector">
            <icscscriptedsql:scriptRoots>/opt/midpoint/var/sql-scripts/mp-to-grouper</icscscriptedsql:scriptRoots>
            <icscscriptedsql:classpath>/opt/midpoint/var/sql-scripts/mp-to-grouper</icscscriptedsql:classpath>
            <icscscriptedsql:scriptBaseClass>BaseScript</icscscriptedsql:scriptBaseClass>
            <icscscriptedsql:searchScriptFileName>SearchScript.groovy</icscscriptedsql:searchScriptFileName>
            <icscscriptedsql:createScriptFileName>CreateUpdateScript.groovy</icscscriptedsql:createScriptFileName>
            <icscscriptedsql:updateScriptFileName>CreateUpdateScript.groovy</icscscriptedsql:updateScriptFileName>
            <icscscriptedsql:deleteScriptFileName>DeleteScript.groovy</icscscriptedsql:deleteScriptFileName>
            <icscscriptedsql:schemaScriptFileName>SchemaScript.groovy</icscscriptedsql:schemaScriptFileName>
            <icscscriptedsql:testScriptFileName>TestScript.groovy</icscscriptedsql:testScriptFileName>
            <icscscriptedsql:syncScriptFileName>SyncScript.groovy</icscscriptedsql:syncScriptFileName>
            <icscscriptedsql:user>${INTERMEDIATE_DB_USER}</icscscriptedsql:user>
            <icscscriptedsql:password>${INTERMEDIATE_DB_PASSWORD}</icscscriptedsql:password>
            <icscscriptedsql:jdbcDriver>org.postgresql.Driver</icscscriptedsql:jdbcDriver>
            <icscscriptedsql:jdbcUrlTemplate xmlns="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/bundle/com.evolveum.polygon.connector-scripted-sql/com.evolveum.polygon.connector.scripted.sql.ScriptedSQLConnector" xmlns:se="http://midpoint.evolveum.com/xml/ns/public/model/scripting/extension-3">jdbc:postgresql://${INTERMEDIATE_DB_SERVER}:${INTERMEDIATE_DB_PORT}/${INTERMEDIATE_DB_NAME}</icscscriptedsql:jdbcUrlTemplate>
            <icscscriptedsql:recompileGroovySource>false</icscscriptedsql:recompileGroovySource>
        </icfc:configurationProperties>
        <icfc:resultsHandlerConfiguration>
            <icfc:enableNormalizingResultsHandler>false</icfc:enableNormalizingResultsHandler>
            <icfc:enableFilteredResultsHandler>false</icfc:enableFilteredResultsHandler>
            <icfc:enableAttributesToGetSearchResultsHandler>false</icfc:enableAttributesToGetSearchResultsHandler>
        </icfc:resultsHandlerConfiguration>
        <icfc:timeouts>
            <icfc:create>180000</icfc:create>
            <icfc:get>180000</icfc:get>
            <icfc:update>180000</icfc:update>
            <icfc:delete>180000</icfc:delete>
            <icfc:test>60000</icfc:test>
            <icfc:scriptOnConnector>180000</icfc:scriptOnConnector>
            <icfc:scriptOnResource>180000</icfc:scriptOnResource>
            <icfc:authentication>60000</icfc:authentication>
            <icfc:search>180000</icfc:search>
            <icfc:validate>180000</icfc:validate>
            <icfc:sync>180000</icfc:sync>
            <icfc:schema>60000</icfc:schema>
        </icfc:timeouts>
    </connectorConfiguration>
    <schema></schema>
    <projection>
        <assignmentPolicyEnforcement>full</assignmentPolicyEnforcement>
        <legalize>true</legalize>
    </projection>
    <schemaHandling>
        <objectType>
            <displayName>Person Group Request Membership</displayName>
            <kind>account</kind>
            <intent>default</intent>
            <default>true</default>
            <delineation>
                <objectClass>ri:AccountObjectClass</objectClass>
            </delineation>
            <focus>
                <type>c:UserType</type>
            </focus>
            <attribute>
                <ref>icfs:name</ref>
                <tolerant>true</tolerant>
                <exclusiveStrong>false</exclusiveStrong>
                <correlator/>
                <outbound>
                    <authoritative>true</authoritative>
                    <exclusive>false</exclusive>
                    <strength>strong</strength>
                    <source>
                        <path>extension/grouperSubjectId</path>
                    </source>
                </outbound>
                <inbound>
                    <authoritative>true</authoritative>
                    <exclusive>false</exclusive>
                    <strength>weak</strength>
                    <target>
                        <path>extension/grouperSubjectId</path>
                    </target>
                </inbound>
            </attribute>
            <attribute>
                <ref>ri:grouperGroupMembershipNames</ref>
                <fetchStrategy>explicit</fetchStrategy>
            </attribute>
            <association>
                <ref>ri:grouperGroupMemberships</ref>
                <kind>entitlement</kind>
                <intent>default</intent>
                <direction>subjectToObject</direction>
                <associationAttribute>ri:grouperGroupMembershipNames</associationAttribute>
                <valueAttribute>icfs:uid</valueAttribute>
                <explicitReferentialIntegrity>false</explicitReferentialIntegrity>
            </association>
            <synchronization>
                <reaction>
                    <situation>linked</situation>
                    <actions>
                        <synchronize />
                    </actions>
                </reaction>
                <reaction>
                    <situation>unlinked</situation>
                    <actions>
                        <link />
                    </actions>
                </reaction>
                <reaction>
                    <situation>unmatched</situation>
                </reaction>
                <reaction>
                    <situation>deleted</situation>
                    <actions>
                        <unlink />
                    </actions>
                </reaction>
            </synchronization>
        </objectType>
        <objectType>
            <displayName>Grouper Group</displayName>
            <kind>entitlement</kind>
            <intent>default</intent>
            <default>true</default>
            <delineation>
                <objectClass>ri:CustomGroupObjectClass</objectClass>
            </delineation>
            <focus>
                <type>c:RoleType</type>
            </focus>
            <attribute>
                <ref>icfs:name</ref>
                <correlator/>
                <outbound>
                    <strength>strong</strength>
                    <source>
                        <path>identifier</path>
                    </source>
                </outbound>
                <inbound>
                    <strength>weak</strength>
                    <target>
                        <path>identifier</path>
                    </target>
                </inbound>
            </attribute>
            <synchronization>
                <reaction>
                    <situation>linked</situation>
                    <actions>
                        <synchronize />
                    </actions>
                </reaction>
                <reaction>
                    <situation>unlinked</situation>
                    <actions>
                        <link />
                    </actions>
                </reaction>
                <reaction>
                    <situation>unmatched</situation>
                </reaction>
                <reaction>
                    <situation>deleted</situation>
                    <actions>
                        <unlink />
                    </actions>
                </reaction>
            </synchronization>
        </objectType>
    </schemaHandling>
</resource>
